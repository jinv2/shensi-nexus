<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Ghost Operator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script type="importmap"> { "imports": { "@google/generative-ai": "https://esm.run/@google/generative-ai" } } </script>
    <style>body{background:#000;color:#ccc;font-family:monospace;} #glass-wall{position:fixed;top:0;left:0;width:100%;height:100%;background:#000;z-index:999;display:flex;justify-content:center;align-items:center;flex-direction:column;}</style>
</head>
<body class="flex flex-col h-screen">

    <!-- çŽ»ç’ƒå¢™ -->
    <div id="glass-wall">
        <h2 class="text-2xl text-gray-500 mb-4">LOCKED</h2>
        <p class="text-xs text-gray-700 mb-6">LOGIN VIA NEXUS REQUIRED</p>
        <a href="https://shensi-nexus.vercel.app" class="border border-gray-600 px-4 py-2 text-gray-400 hover:text-white">GO TO HUB</a>
    </div>

    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <div class="h-12 border-b border-gray-800 flex justify-between items-center px-4 bg-gray-900">
        <span class="font-bold text-white">GHOST OPERATOR</span>
        <div class="flex gap-4">
            <span id="user-status" class="text-xs text-green-600"></span>
            <button onclick="logout()" class="text-xs text-red-500 hover:text-red-300">[ LOGOUT ]</button>
        </div>
    </div>

    <!-- å†…å®¹åŒº (ä½ çš„åŽŸåŠŸèƒ½ä»£ç ) -->
    <div class="flex-1 flex items-center justify-center">
        <div class="text-center">
            <p class="mb-4">VISUAL RPA ENGINE READY</p>
            <!-- âš ï¸ è¿™é‡Œæ”¾ä½ ä¹‹å‰çš„ä¸Šä¼ æˆªå›¾åŠŸèƒ½ï¼Œä¸ºèŠ‚çœç¯‡å¹…ç•¥åŽ»ï¼Œè¯·ä¿ç•™ä½ çš„æ ¸å¿ƒé€»è¾‘ -->
        </div>
    </div>

    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";
        const SB_URL = 'https://enutekcevqcmhrzwdnlt.supabase.co';
        const SB_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVudXRla2NldnFjbWhyendkbmx0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY3ODg1MjAsImV4cCI6MjA4MjM2NDUyMH0.WrZ3sRH-0HVXv5NNPTvm00l5kC4qURAaxq0jinxND3E';
        const sb = supabase.createClient(SB_URL, SB_KEY);

        // ðŸŸ¢ æ ¸å¿ƒé‰´æƒä¿®å¤
        (async function init() {
            // 1. æ£€æŸ¥ URL Token
            const hash = window.location.hash;
            if (hash && hash.includes('access_token')) {
                const params = new URLSearchParams(hash.substring(1));
                const { data, error } = await sb.auth.setSession({
                    access_token: params.get('access_token'),
                    refresh_token: params.get('refresh_token')
                });
                if (!error && data.session) {
                    window.history.replaceState({}, document.title, window.location.pathname);
                    unlock(data.session.user.email);
                    return;
                }
            }
            // 2. æ£€æŸ¥æœ¬åœ° Session
            const { data: { session } } = await sb.auth.getSession();
            if (session) unlock(session.user.email);
        })();

        function unlock(email) {
            document.getElementById('glass-wall').style.display = 'none';
            document.getElementById('user-status').innerText = email;
        }

        window.logout = async () => {
            await sb.auth.signOut();
            window.location.reload();
        }
    </script>
</body>
</html>

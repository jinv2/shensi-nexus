<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>神思庭 | Shensi-Nexus</title>
    
    <!-- 正确加载 Tailwind CSS（关键修复） -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <style>
        /* 您的原有样式全部保留，无需修改 */
        body { background-color: #000; color: #e5e5e5; font-family: 'Courier New', monospace; overflow-x: hidden; }
        #data-stream { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.3; pointer-events: none; }
        .nexus-container { width: 100%; max-width: 600px; margin: 0 auto; display: flex; flex-direction: column; align-items: center; position: relative; z-index: 10; }
        .nexus-border { border: 1px solid #333; background: rgba(10,10,10,0.85); box-shadow: 0 0 30px rgba(0,0,0,0.8); backdrop-filter: blur(8px); width: 100%; border-radius: 4px; }
        .btn-main { background: #d4af37; color: #000; font-weight: 800; padding: 15px; width: 100%; cursor: pointer; text-transform: uppercase; letter-spacing: 2px; border: none; transition: 0.3s; }
        .btn-main:hover { background: #fff; box-shadow: 0 0 20px #d4af37; }
        .input-dark { background: #0a0a0a; border: 1px solid #444; color: #d4af37; width: 100%; padding: 15px; text-align: center; outline: none; font-size: 14px; margin-bottom: 10px; }
        .input-dark:focus { border-color: #d4af37; }
        /* 五维轮 + 其他样式全部复制您的原始代码，这里省略以节省篇幅，但请完整保留 */
        /* ... 您的所有 .wheel-wrapper .magic-wheel 等样式 ... */
        .app-item { display: flex; justify-content: space-between; align-items: center; padding: 20px; margin-bottom: 10px; border-left: 4px solid transparent; transition: 0.2s; cursor: pointer; }
        .app-btn { padding: 5px 15px; border: 1px solid #444; font-size: 10px; font-weight: bold; background: #000; white-space: nowrap; cursor: pointer; transition: all 0.3s ease; }
        .app-btn:hover { background: #fff; color: #000 !important; }
    </style>
</head>
<body class="min-h-screen flex flex-col justify-center py-10">
    <canvas id="data-stream"></canvas>

    <div id="app" class="nexus-container" style="display: none;">
        <!-- 头部 + 五维轮 + 列表等模板代码完全保留您的原始结构 -->

        <!-- 登录界面（支持邮箱 + 邀请码双入口） -->
        <div v-if="!isUnlocked" class="nexus-border p-10 w-full">
            <div class="text-center mb-8">
                <i class="fas fa-fingerprint text-4xl text-gray-600 mb-4"></i>
                <p class="text-xs text-gray-400 tracking-widest uppercase">Identity Verification Required</p>
            </div>
            
            <!-- 邮箱登录 -->
            <input v-model="email" type="email" placeholder="ENTER ACCESS EMAIL" class="input-dark">
            <button @click="handleLogin" :disabled="loading" class="btn-main mb-6">
                {{ loading ? 'CONNECTING...' : 'INITIALIZE SYSTEM' }}
            </button>
            
            <!-- 或使用邀请码 -->
            <div class="text-center text-gray-500 text-xs uppercase">OR ACTIVATE WITH GIFT CODE</div>
            <div class="flex gap-2 mt-4">
                <input v-model="inviteCode" placeholder="ENTER GIFT CODE" class="input-dark flex-1">
                <button @click="redeem" class="btn-main px-8">EXEC</button>
            </div>
        </div>

        <!-- 主控制台（已解锁后显示） -->
        <div v-else class="w-full">
            <!-- 您的完整主界面代码（身份条、五维轮、Automation Matrix 等） -->
            
            <!-- 在 Automation tab 中添加最高级别密码保护 -->
            <div v-if="activeTab === 'automation'">
                <div v-if="!showUltimate" class="text-center py-10 nexus-border">
                    <p class="text-xs text-gray-500 mb-4 uppercase">ULTIMATE PROTOCOL LOCKED</p>
                    <input v-model="secretPassword" type="password" placeholder="ENTER FINAL KEY" class="input-dark w-64">
                    <button @click="checkUltimate" class="btn-main mt-4">UNLOCK</button>
                </div>
                
                <div v-else class="text-center py-10">
                    <p class="text-yellow-500 text-lg uppercase tracking-widest">FULL SYSTEM CONTROL ACTIVATED</p>
                    <div class="app-item nexus-border my-4">
                        <div>ETERNAL GHOST MODE · 无限制视觉自动化</div>
                        <div class="app-btn text-yellow-500">RUN</div>
                    </div>
                </div>
                
                <!-- 您的三个核心模块（始终可用） -->
                <div class="app-item nexus-border" style="border-left-color: #d1d5db;">
                    <div><div class="text-xs uppercase">Ghost Operator (AI 幽灵)</div><div class="text-[10px]">无 API 全界面操作 · 视觉大脑驱动的网页自动化</div></div>
                    <div class="app-btn text-gray-300">DEPLOY</div>
                </div>
                <!-- Vibe Coding 和 Monitor Eye 同理 -->
            </div>
            
            <!-- 底部 LOGOUT -->
            <div class="mt-8 text-center">
                <div class="text-[10px] text-red-900 cursor-pointer hover:text-red-500" @click="signOut">[ LOGOUT ]</div>
            </div>
        </div>
    </div>

    <script>
        /* 您的粒子背景代码完整保留 */

        const SB_URL = 'https://enutekcevqcmhrzwdnlt.supabase.co';
        const SB_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVudXRla2NldnFjbWhyendkbmx0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY3ODg1MjAsImV4cCI6MjA4MjM2NDUyMH0.WrZ3sRH-0HVXv5NNPTvm00l5kC4qURAaxq0jinxND3E';

        window.onload = function() {
            const sbClient = supabase.createClient(SB_URL, SB_KEY);
            const { createApp, ref, onMounted } = Vue;

            createApp({
                setup() {
                    const user = ref(null);
                    const email = ref('');
                    const loading = ref(false);
                    const inviteCode = ref('');
                    const isUnlocked = ref(false);
                    const secretPassword = ref('');
                    const showUltimate = ref(false);
                    const activeTab = ref('automation'); // 默认打开自动化矩阵

                    // 检查本地持久化
                    onMounted(() => {
                        if (localStorage.getItem('shensi_unlocked') === 'true') {
                            isUnlocked.value = true;
                            showUltimate.value = localStorage.getItem('shensi_ultimate') === 'true';
                        }
                        // Supabase session 检查（可选保留）
                        sbClient.auth.getSession().then(({ data: { session } }) => {
                            if (session) {
                                user.value = session.user;
                                isUnlocked.value = true;
                                localStorage.setItem('shensi_unlocked', 'true');
                            }
                        });
                        document.getElementById('app').style.display = 'block';
                    });

                    const handleLogin = async () => {
                        loading.value = true;
                        const { error } = await sbClient.auth.signInWithOtp({ email: email.value });
                        if (!error) alert('Magic Link 已发送至邮箱，请查收！');
                        loading.value = false;
                    };

                    const redeem = () => {
                        const validCodes = ['SHENSI2025', 'GHOST2025', 'NEXUS', '您的其他邀请码']; // 在此添加您的邀请码
                        if (validCodes.includes(inviteCode.value.toUpperCase())) {
                            isUnlocked.value = true;
                            localStorage.setItem('shensi_unlocked', 'true');
                            alert('ACCESS GRANTED · 永久解锁');
                            inviteCode.value = '';
                        } else {
                            alert('INVALID CODE');
                        }
                    };

                    const checkUltimate = () => {
                        if (secretPassword.value === 'ETERNAL2026') { // 改成您想要的最高级别密码
                            showUltimate.value = true;
                            localStorage.setItem('shensi_ultimate', 'true');
                        } else {
                            alert('ACCESS DENIED');
                        }
                    };

                    const signOut = () => {
                        localStorage.clear();
                        location.reload();
                    };

                    return { isUnlocked, email, loading, inviteCode, handleLogin, redeem, secretPassword, showUltimate, checkUltimate, signOut, activeTab /* 其他变量 */ };
                }
            }).mount('#app');
        };
    </script>
</body>
</html>
